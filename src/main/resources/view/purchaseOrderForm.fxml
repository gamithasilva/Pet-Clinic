<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="lk.ijse.petclinic.controller.PurchaseOrderFormController"
            style="-fx-background-color: #1a1a1a;" prefWidth="1000" prefHeight="700">

    <!-- Top Header -->
    <top>
        <VBox spacing="15" style="-fx-background-color: linear-gradient(to bottom, #000000, #1a1a1a); -fx-border-color: #333333; -fx-border-width: 0 0 2 0;">
            <padding>
                <Insets top="20" right="25" bottom="20" left="25"/>
            </padding>

            <!-- Title Section -->
            <HBox alignment="CENTER_LEFT" spacing="15">
                <children>
                    <VBox alignment="CENTER" style="-fx-background-color: white; -fx-background-radius: 30; -fx-padding: 12;">
                        <children>
                            <ImageView fitHeight="35.0" fitWidth="35.0" pickOnBounds="true" preserveRatio="true">
                                <image>
                                    <Image url="@../image/icons8-order-50.png" />
                                </image>
                            </ImageView>
                        </children>
                    </VBox>

                    <VBox spacing="2">
                        <children>
                            <Label text="New Purchase Order" style="-fx-text-fill: white; -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.3), 8, 0, 0, 0);">
                                <font>
                                    <Font name="System Bold" size="28"/>
                                </font>
                            </Label>
                            <Label text="Create a new medicine order" style="-fx-text-fill: #999999; -fx-font-size: 13;">
                                <font>
                                    <Font size="13"/>
                                </font>
                            </Label>
                        </children>
                    </VBox>
                </children>
            </HBox>

            <!-- Supplier Selection -->
            <HBox spacing="20" alignment="CENTER_LEFT">
                <children>
                    <!-- Supplier Selection -->
                    <VBox spacing="8">
                        <children>
                            <Label text="Supplier" style="-fx-text-fill: #cccccc; -fx-font-weight: bold; -fx-font-size: 12;">
                                <font>
                                    <Font name="System Bold" size="12"/>
                                </font>
                            </Label>
                            <ComboBox fx:id="supplierComboBox" promptText="Select Supplier" prefWidth="300" prefHeight="38" styleClass="supplier-combo" style="-fx-background-color: #262626; -fx-text-fill: white; -fx-prompt-text-fill: #666666; -fx-background-radius: 10; -fx-border-color: #404040; -fx-border-radius: 10; -fx-border-width: 2;"/>
                        </children>
                    </VBox>

                    <!-- Order Date -->
                    <VBox spacing="8">
                        <children>
                            <Label text="Order Date" style="-fx-text-fill: #cccccc; -fx-font-weight: bold; -fx-font-size: 12;">
                                <font>
                                    <Font name="System Bold" size="12"/>
                                </font>
                            </Label>
                            <DatePicker fx:id="orderDatePicker" prefWidth="180" prefHeight="38" style="-fx-background-color: #262626; -fx-text-fill: white; -fx-background-radius: 10; -fx-border-color: #404040; -fx-border-radius: 10; -fx-border-width: 2;"/>
                        </children>
                    </VBox>
                </children>
            </HBox>
        </VBox>
    </top>

    <!-- Main Content Area -->
    <center>
        <SplitPane dividerPositions="0.4" style="-fx-background-color: #1a1a1a;">

            <!-- LEFT PANEL - Medicine Selection -->
            <VBox spacing="12" style="-fx-background-color: #0d0d0d; -fx-border-color: #333333; -fx-border-width: 0 1 0 0;">
                <padding>
                    <Insets top="20" right="15" bottom="15" left="20"/>
                </padding>

                <Label text="Available Medicines" style="-fx-text-fill: white; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="18"/>
                    </font>
                </Label>

                <!-- Search Box -->
                <HBox alignment="CENTER_LEFT" spacing="10" style="-fx-background-color: #262626; -fx-background-radius: 10; -fx-border-color: #404040; -fx-border-radius: 10; -fx-border-width: 2; -fx-padding: 10;">
                    <children>
                        <ImageView fitHeight="20.0" fitWidth="20.0" opacity="0.6" pickOnBounds="true" preserveRatio="true">
                            <image>
                                <Image url="@../image/icons8-search-50.png" />
                            </image>
                        </ImageView>
                        <TextField fx:id="searchField" promptText="Search medicine by name..." prefWidth="300" style="-fx-background-color: transparent; -fx-text-fill: white; -fx-prompt-text-fill: #666666; -fx-border-width: 0; -fx-font-size: 13;" HBox.hgrow="ALWAYS">
                            <font>
                                <Font size="13"/>
                            </font>
                        </TextField>
                    </children>
                </HBox>

                <!-- Medicine List -->
                <ListView fx:id="medicineListView" VBox.vgrow="ALWAYS" style="-fx-background-color: #1a1a1a; -fx-border-color: #333333; -fx-border-width: 2; -fx-border-radius: 10; -fx-background-radius: 10;"/>

                <!-- Quantity Input Section -->
                <VBox spacing="8" style="-fx-background-color: #262626; -fx-background-radius: 10; -fx-padding: 15; -fx-border-color: #404040; -fx-border-radius: 10; -fx-border-width: 2;">
                    <children>
                        <Label text="Order Quantity" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 13;">
                            <font>
                                <Font name="System Bold" size="13"/>
                            </font>
                        </Label>

                        <HBox spacing="10" alignment="CENTER_LEFT">
                            <children>
                                <!-- Decrease Button -->
                                <Button fx:id="decreaseBtn" text="-" onAction="#handleDecreaseQuantity" prefWidth="40" prefHeight="40" style="-fx-background-color: #404040; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 20; -fx-background-radius: 20; -fx-cursor: hand; -fx-border-color: #666666; -fx-border-radius: 20; -fx-border-width: 2;">
                                    <font>
                                        <Font name="System Bold" size="20"/>
                                    </font>
                                </Button>

                                <!-- Quantity TextField -->
                                <TextField fx:id="quantityField" text="1" alignment="CENTER" prefWidth="80" prefHeight="40" style="-fx-background-color: #1a1a1a; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 18; -fx-background-radius: 10; -fx-border-color: #666666; -fx-border-radius: 10; -fx-border-width: 2;">
                                    <font>
                                        <Font name="System Bold" size="18"/>
                                    </font>
                                </TextField>

                                <!-- Increase Button -->
                                <Button fx:id="increaseBtn" text="+" onAction="#handleIncreaseQuantity" prefWidth="40" prefHeight="40" style="-fx-background-color: #404040; -fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 20; -fx-background-radius: 20; -fx-cursor: hand; -fx-border-color: #666666; -fx-border-radius: 20; -fx-border-width: 2;">
                                    <font>
                                        <Font name="System Bold" size="20"/>
                                    </font>
                                </Button>

                                <Label fx:id="unitLabel" text="tablets" style="-fx-text-fill: #999999; -fx-font-size: 13;">
                                    <font>
                                        <Font size="13"/>
                                    </font>
                                </Label>
                            </children>
                        </HBox>
                    </children>
                </VBox>

                <!-- Add Button -->
                <Button fx:id="addMedicineBtn" text="Add to Order ➜" onAction="#handleAddMedicine" prefWidth="250" prefHeight="45" style="-fx-background-color: white; -fx-text-fill: black; -fx-font-weight: bold; -fx-background-radius: 23; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.4), 8, 0, 0, 0); -fx-font-size: 14;">
                    <font>
                        <Font name="System Bold" size="14"/>
                    </font>
                </Button>

                <!-- Stock Info -->
                <VBox spacing="5" style="-fx-background-color: #262626; -fx-background-radius: 10; -fx-padding: 12; -fx-border-color: #404040; -fx-border-radius: 10; -fx-border-width: 1;">
                    <children>
                        <Label text="ℹ️ Stock Information" style="-fx-text-fill: #cccccc; -fx-font-weight: bold; -fx-font-size: 11;">
                            <font>
                                <Font name="System Bold" size="11"/>
                            </font>
                        </Label>
                        <Label fx:id="stockInfoLabel" text="Select a medicine to see details" style="-fx-text-fill: #999999; -fx-font-size: 12;" wrapText="true">
                            <font>
                                <Font size="12"/>
                            </font>
                        </Label>
                    </children>
                </VBox>
            </VBox>

            <!-- RIGHT PANEL - Order Items -->
            <VBox spacing="12" style="-fx-background-color: #1a1a1a;">
                <padding>
                    <Insets top="20" right="20" bottom="15" left="15"/>
                </padding>

                <Label text="Order Items" style="-fx-text-fill: white; -fx-font-weight: bold;">
                    <font>
                        <Font name="System Bold" size="18"/>
                    </font>
                </Label>

                <!-- Order Items Table -->
                <TableView fx:id="orderItemsTable" VBox.vgrow="ALWAYS" style="-fx-background-color: #0d0d0d; -fx-border-color: #333333; -fx-border-width: 2; -fx-border-radius: 10; -fx-background-radius: 10;">
                    <columns>
                        <TableColumn fx:id="colMedicineName" text="Medicine Name" prefWidth="180" minWidth="120"/>
                        <TableColumn fx:id="colGenericName" text="Generic Name" prefWidth="150" minWidth="100"/>
                        <TableColumn fx:id="colQuantity" text="Quantity" prefWidth="90" minWidth="80"/>
                        <TableColumn fx:id="colUnitPrice" text="Unit Price" prefWidth="100" minWidth="90"/>
                        <TableColumn fx:id="colSubtotal" text="Subtotal" prefWidth="100" minWidth="90"/>
                        <TableColumn fx:id="colAction" text="Action" prefWidth="80" minWidth="70"/>
                    </columns>
                    <placeholder>
                        <VBox alignment="CENTER" spacing="10">
                            <children>
                                <ImageView fitHeight="50.0" fitWidth="50.0" opacity="0.3" pickOnBounds="true" preserveRatio="true">
                                    <image>
                                        <Image url="@../image/icons8-empty-box-50.png" />
                                    </image>
                                </ImageView>
                                <Label text="No items added yet" style="-fx-text-fill: #666666; -fx-font-size: 14;">
                                    <font>
                                        <Font size="14"/>
                                    </font>
                                </Label>
                                <Label text="Select medicines from the left panel" style="-fx-text-fill: #999999; -fx-font-size: 12;">
                                    <font>
                                        <Font size="12"/>
                                    </font>
                                </Label>
                            </children>
                        </VBox>
                    </placeholder>
                </TableView>

                <!-- Order Summary -->
                <VBox spacing="12" style="-fx-background-color: #0d0d0d; -fx-background-radius: 12; -fx-border-color: #333333; -fx-border-radius: 12; -fx-border-width: 2; -fx-padding: 20;">
                    <children>
                        <Label text="Order Summary" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 14;">
                            <font>
                                <Font name="System Bold" size="14"/>
                            </font>
                        </Label>

                        <HBox spacing="10" alignment="CENTER_RIGHT">
                            <children>
                                <Label text="Total Items:" style="-fx-text-fill: #cccccc; -fx-font-size: 13;">
                                    <font>
                                        <Font size="13"/>
                                    </font>
                                </Label>
                                <Label fx:id="totalItemsLabel" text="0" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 13;">
                                    <font>
                                        <Font name="System Bold" size="13"/>
                                    </font>
                                </Label>
                            </children>
                        </HBox>

                        <Separator style="-fx-background-color: #333333;"/>

                        <HBox spacing="10" alignment="CENTER_RIGHT">
                            <children>
                                <Label text="Total Amount:" style="-fx-text-fill: white; -fx-font-weight: bold; -fx-font-size: 16;">
                                    <font>
                                        <Font name="System Bold" size="16"/>
                                    </font>
                                </Label>
                                <Label fx:id="totalAmountLabel" text="Rs. 0.00" style="-fx-text-fill: #00ff88; -fx-font-weight: bold; -fx-font-size: 20; -fx-effect: dropshadow(gaussian, rgba(0,255,136,0.3), 5, 0, 0, 0);">
                                    <font>
                                        <Font name="System Bold" size="20"/>
                                    </font>
                                </Label>
                            </children>
                        </HBox>
                    </children>
                </VBox>
            </VBox>
        </SplitPane>
    </center>

    <!-- Bottom Action Buttons -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_RIGHT" style="-fx-background-color: linear-gradient(to top, #000000, #1a1a1a); -fx-border-color: #333333; -fx-border-width: 2 0 0 0; -fx-padding: 20;">
            <padding>
                <Insets top="20" right="25" bottom="20" left="25"/>
            </padding>

            <Button fx:id="clearBtn" text="Clear All" onAction="#handleClearAll" prefWidth="130" prefHeight="45" style="-fx-background-color: #262626; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 23; -fx-border-color: #404040; -fx-border-radius: 23; -fx-border-width: 2; -fx-cursor: hand; -fx-font-size: 13;">
                <font>
                    <Font name="System Bold" size="13"/>
                </font>
            </Button>

            <Button fx:id="cancelBtn" text="Cancel" onAction="#handleCancel" prefWidth="130" prefHeight="45" style="-fx-background-color: #333333; -fx-text-fill: white; -fx-font-weight: bold; -fx-background-radius: 23; -fx-border-color: #666666; -fx-border-radius: 23; -fx-border-width: 2; -fx-cursor: hand; -fx-font-size: 13;">
                <font>
                    <Font name="System Bold" size="13"/>
                </font>
            </Button>

            <Button fx:id="saveBtn" text="Save Order" onAction="#handleSaveOrder" prefWidth="160" prefHeight="45" style="-fx-background-color: white; -fx-text-fill: black; -fx-font-weight: bold; -fx-background-radius: 23; -fx-cursor: hand; -fx-effect: dropshadow(gaussian, rgba(255,255,255,0.4), 10, 0, 0, 0); -fx-font-size: 14;">
                <font>
                    <Font name="System Bold" size="14"/>
                </font>
            </Button>
        </HBox>
    </bottom>

</BorderPane>